
<!doctype html>
<html lang="ru" class="no-js">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    
    <meta name="author" content="Vladimir Penzin">
    
    
    <link rel="canonical" href="https://github.com/ForceFledgling/ForceFledgling/modules/devops/ansible/part1/">
    
    
    <link rel="prev" href="../../linux_tools/home_work/">
    
    
    <link rel="next" href="../home_work/">
    
    
    <link rel="icon" href="../../../../assets/images/logo.svg">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.2.5">

    <!-- Social meta -->
    <meta property="og:title" content="NotiLog">
    <meta property="og:type" content="website">

    

    <meta property="og:image" content="https://github.com/ForceFledgling/ForceFledgling/modules/devops/ansible/part1/assets/images/preview.jpg">
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <meta property="og:url" content="https://github.com/ForceFledgling/ForceFledgling/modules/devops/ansible/part1/">
    <meta property="og:type" content="website">

    
      
        <title>Ansibe ч.1 - Личные заметки</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../assets/styles/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Верхний колонтитул">
    <a href="../../../.." title="Личные заметки" class="md-header__button md-logo" aria-label="Личные заметки" data-md-component="logo">
      
  <img src="../../../../assets/images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Личные заметки
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ansibe ч.1
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Поиск" placeholder="Поиск" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Поиск">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Поделиться" aria-label="Поделиться" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Очистить" aria-label="Очистить" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Инициализация поиска
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ForceFledgling/ForceFledgling" title="Перейти к репозиторию" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    github
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Вкладки" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  Главная

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../dev/" class="md-tabs__link">
          
  
  Dev

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../git/" class="md-tabs__link">
          
  
  Git

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../python/" class="md-tabs__link">
          
  
  Python

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  DevOps

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Навигация" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Личные заметки" class="md-nav__button md-logo" aria-label="Личные заметки" data-md-component="logo">
      
  <img src="../../../../assets/images/logo.svg" alt="logo">

    </a>
    Личные заметки
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ForceFledgling/ForceFledgling" title="Перейти к репозиторию" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Главная
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Главная
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Главная
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../courses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Каталог курсов
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Каталог заметок
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dev
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Dev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Обзор
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Жизненный цикл разработки ПО
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Жизненный цикл разработки ПО
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/apps/sdlc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDLС (этапы, практики, методологии)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/apps/req/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Работа с требованиями (типы требований, DoD, DoR, декомпозиция и оценка)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/apps/cicd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI/CD (Continuous Integration и Continuous Delivery)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/apps/releases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases (типы, отличия)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/apps/agile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Управлению разработкой (Agile, Scrum, aтрибуты, Канбан)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Структуры данных и алгоритмы
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/softdesign/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/arch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Архитектура
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/sysdesign/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/websec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web безопасность
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/qos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Обеспечение качества
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Оптимизация и производительность
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/front/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frontend Development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Базы данных
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/softskills/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Soft Skills
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_14" >
        
          
          <label class="md-nav__link" for="__nav_2_14" id="__nav_2_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Прочее
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_14">
            <span class="md-nav__icon md-icon"></span>
            Прочее
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/other/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Обзор
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/other/diagrams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Диаграммы
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/other/analizes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Анализы
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Git
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Git
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Обзор
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Обзор
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Основы Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Основы Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/base/types-and-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Типы и структуры данных
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/base/iterators-generators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Итераторы, генераторы
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/base/context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Менеджер контекста
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/base/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Исключения
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ООП в Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            ООП в Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/oop/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Объекты, области видимости
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/oop/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Объекты, области видимости
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/oop/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Объекты, области видимости
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/oop/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Объекты, области видимости
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Фреймворки и библиотеки
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Фреймворки и библиотеки
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/libs/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Типы и различия
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/libs/web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/libs/orm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ORM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/libs/math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Math
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/parallelizm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Многопоточность и асинхронность
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Логирование, мониторинг
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Базы данных
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Тестирование и контроль качества кода
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Тестирование и контроль качества кода
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/tests/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Пирамида тестирования и умение писать тесты
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/tests/linters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pylint, Pytest, PEP-8, PEP-257
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Отладка и профилирование
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Отладка и профилирование
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/debug/cython/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cython
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/debug/numba/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numba
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/debug/points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Условные точки останова
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/debug/trace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Трассировка
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/debug/async/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Отладка многопоточного и асинхронного кода
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/debug/interpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Отладка на уровне интерпретатора
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    DevOps
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            DevOps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Вводный модуль
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Linux
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Подключение к ВМ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Основы Shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/home_work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Домашнее задание №1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Инструменты командной строки Linux
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Инструменты командной строки Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Инструменты командной строки Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_tools/home_work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Домашнее задание №2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" checked>
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ansible
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Ansible
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Ansibe ч.1
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../home_work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Домашнее задание №3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ansible ч.2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ansible ч.3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Наблюдаемость
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Наблюдаемость
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visiblity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Наблюдаемость
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visiblity/home_work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Домашнее задание №4
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docker
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/home_work1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Домашнее задание №5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/compose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker и Compose
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/home_work2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Домашнее задание №6
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GitLab CI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            GitLab CI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gitlab_ci/part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitLab CI Harbor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gitlab_ci/part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitLab CI ч.2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gitlab_ci/home_work1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Домашнее задание №7
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gitlab_ci/part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitLab CI ч.3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gitlab_ci/home_work2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Домашнее задание №8
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vault
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Vault
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vault/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vault
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../isec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ISEC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../finish_work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Итоговая самостоятельная работа
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Содержание">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/ForceFledgling/ForceFledgling/blob/main/docs/modules/devops/ansible/part1.md" title="Редактировать страницу" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


  <h1>Ansibe ч.1</h1>

<p>Системы управления конфигурациями позволяют настраивать существующие компоненты инфраструктуры (в основном виртуальные или физические сервера). Такие системы разделяют на две большие категории по модели их работы:  </p>
<p>Push модель — конфигурация загружается на целевой компонент извне, из какой-либо внешней локации (мы толкаем изменения в цель);<br />
Pull модель — конфигурация загружается на целевой компонент агентом из известного хранилища конфигураций, установленным на этот компонент (цель тянет изменения сама);<br />
Push модель проще в реализации, т.к. не требует поддержания централизованного хранилища конфигураций (задачи обновления могут запускаться вручную, при помощи CI задач и т. п.), но она хуже масштабируется, т.к. для запуска синхронизации множества целей используются ресурсы одной машины.  </p>
<p>Pull модель же сложнее и создает новый класс проблем, связанных с синхронным обновлением конфигурации в кластерах (например при обновлении кластера etcd нужно контролировать, чтобы хосты перезапускались так, чтобы не нарушался кворум), но при этом лучше масштабируется, т.к. для применения конфигурации используются ресурсы целей, а не какой-то одной машины, с которой запускается процесс в Push модели.</p>
<p>Предварительная настройка</p>
<p>На занятиях мы рассмотрим систему управления конфигурациями Ansible, т.к. это самая популярная подобная система и она широко применяется как в МТС, так и за его пределами.  </p>
<p>Ansible использует Push модель и поддерживает настройку Linux, Windows хостов, а также других целей при помощи различных плагинов подключения.  </p>
<p>На Linux Ansible использует SSH для подключения к хосту и для выполнения операций запускает на целях автоматически сгенерированные скрипты на Python.  </p>
<p>Введем основную терминологию Ansible, которая часто встречается в документации:<br />
Контроллер (controller) — хост, с которого запускается Ansible;<br />
Цель (target) — хосты, на которых Ansible выполняет действия;<br />
Инвентарь (inventory) — набор целей, с привязанными к ним параметрами (параметры подключения, переменные для запускаемых скриптов и т. п.);<br />
Группа (group) — именованное множество целей, с привязанным к нему параметрами;<br />
Модуль (module) — минимально возможная операция в Ansible;<br />
Задача (task) — модуль с параметрами запуска (например условиями);<br />
Роль (role) — переиспользуемая последовательность задач;<br />
Плей (play) — последовательность ролей и отдельных задач, запускаемых на конкретном множестве целей;<br />
Плейбук (playbook) -- последовательность плеев.  </p>
<p>Обратите внимание, что Ansible четко разделяет что мы запускаем (задачи, роли) от того, где мы это запускаем (плеи, плейбуки, инвентари). Такое разделение позволяет писать переиспользуемые конфигурации.  </p>
<p>Познакомимся с названными концепциями подробнее. Мы устанавливали Ansible на первом занятии, приведем команды для установки еще раз:</p>
<div class="highlight"><pre><span></span><code>$ sudo apt-add-repository --update ppa:ansible/ansible
$ sudo apt install ansible
</code></pre></div>
<p>Создайте рабочую область для Ansible, далее все операции мы будем выполнять в ней:</p>
<div class="highlight"><pre><span></span><code>$ mkdir -p ~/projects/ansible
$ cd ~/projects/ansible
</code></pre></div>
<p>Начнем с создания Ansible инвентаря, в который добавим наши ВМ.  </p>
<p>Создайте файл hosts. yaml в рабочей области:</p>
<div class="highlight"><pre><span></span><code>all:
  vars:
    ansible_user: student  # SSH пользователь, используемый Ansible
    ansible_ssh_private_key_file: &quot;~/.ssh/id_rsa&quot;  # Путь к приватному SSH ключу на контроллере
  hosts:
    vm1:
      ansible_host: 10.0.10.1  # Адрес, используемый Ansible для подключения.
                               # Должен быть доступен с контроллера
    vm2:
      ansible_host: 10.0.10.2
  children:
    part1:
    part2:
part1:
  hosts:
    vm1:
part2:
  hosts:
    vm2:
</code></pre></div>
<p>В корне YAML файла объявляются группы целей, мы объявили три — all, part1, part2. Если быть точнее, то группу all мы не объявляли — она служебная, существует всегда и содержит все объявленные в инвентаре цели. Из-за этого описывать в ней все обязательные параметры целей (чаще всего параметры подключения) — распространенная практика.  </p>
<p>В группе all мы объявили три секции — vars, hosts, children. В vars содержатся переменные группы, в hosts — имена целей с их персональными переменными, в children — имена дочерних групп (родительская группа будет содержать цели и переменные своих дочерних групп). Такая запись children ничего не меняет, т.к. all является родительской группой всех остальных групп по-умолчанию.</p>
<p>Ansible нет понятия области видимости переменных — все переменные глобальные и набор переменных конкретной цели формируется слиянием переменных всех групп, в которых состоит хост и его личных переменных.</p>
<p>Далее мы объявляем две группы — part1 и part2 и добавляем vm1 в первую, vm2 — во вторую. Обратите внимание, что мы можем дополнить переменные целей, когда указываем, что они часть группы. Такой прием имеет смысл в больших инвентарях, чтобы группировать переменные по смыслу.  </p>
<p>Теперь напишем конфигурацию запуска Ansible. Создайте в рабочей области файл ansible. cfg:</p>
<div class="highlight"><pre><span></span><code>[defaults] 
host_key_checking = false 
inventory = ./hosts.yaml
</code></pre></div>
<p>Ansible по умолчанию включает проверку ключа хоста. Проверка ключей хоста защищает от подмены сервера и атак «человек посередине», но требует некоторого обслуживания. Если хост переустановлен и имеет другой ключ в «known_hosts», это приведет к появлению сообщения об ошибке, пока оно не будет исправлено. Если нового хоста нет в «known_hosts», ваш управляющий узел может запросить подтверждение ключа, что приводит к интерактивному взаимодействию при использовании Ansible.  </p>
<p>Отключается через host_key_checking = false.<br />
Проверим, что инвентарь написан корректно. Следующая команда выведет полное содержимое инвентаря во внутреннем формате Ansible:</p>
<div class="highlight"><pre><span></span><code>$ ansible-inventory --list
</code></pre></div>
<p>И проверим подключение ко всем хостам:</p>
<div class="highlight"><pre><span></span><code>$ ansible -m ping all
</code></pre></div>
<p>Ручные действия</p>
<p>Ansible позволяет применять изменения к целям из консоли при помощи команды ansible, таким образом мы только что проверили доступность целей инвентаря. Основной синтаксис команды таков:</p>
<div class="highlight"><pre><span></span><code>$ ansible &lt;-m | --module-name MODULE_NAME&gt; [-b | --become] [-a | --args MODULE_ARGS] [-e | --extra-args EXTRA_ARGS] &lt;HOST_PATTERN&gt;
</code></pre></div>
<p>Здесь:<br />
-m | --module-name MODULE_NAME — имя запускаемого модуля;<br />
-b | --become — повысить привилегии до root перед запуском модуля;<br />
-a | --args MODULE_ARGS — аргументы модуля в формате ключ-значение (key1=value1 key2=value2 …);<br />
-e | --extra-args EXTRA_ARGS — дополнительные переменные в формате ключ-значение;<br />
HOST_PATTERN — набор целей; здесь можно указывать имена целей и групп, разделяя их.  </p>
<p>Эта команда поддерживает множество других параметров, посмотреть которые можно при помощи команды ansible — help.<br />
Зная синтаксис команды, установим и запустим Nginx на ВМ2:</p>
<div class="highlight"><pre><span></span><code>$ ansible -b -m apt -a &#39;name=nginx update_cache=true state=present&#39; vm2 
$ ansible -b -m systemd_service -a &#39;name=nginx.service enabled=true state=started&#39; vm2
</code></pre></div>
<p>Первый модуль выполнил аналог команды sudo sh -c 'apt update &amp;&amp; apt install nginx'.<br />
Второй — sudo systemctl enable --now nginx. service.<br />
Информация об аргументах доступна на сайте документации Ansible — <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html">ansible.builtin.apt</a>, <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/systemd_service_module.html#ansible-collections-ansible-builtin-systemd-service-module">ansible.builtin.systemd_service</a>.  </p>
<p>При выполнении ad-hoc операций или тестировании модулей писать каждый раз аргументы ansible и набор целей неудобно. Если вам требуется выполнять такие операции используйте интерактивную консоль ansible-console.  </p>
<p>Обратите внимание на вывод команд: каждый вызов ansible запустил по одной задаче на vm2 и завершился со статусом ok или changed. Во время запуска модуля Ansible проверяет нужны ли изменения на целевом хосте и ничего не делает, если действий не требуется.  </p>
<p>Статус ok отражает такую ситуацию — хост уже в целевом состоянии, действий не требуется. changed показывает обратную ситуацию — хост не был в целевом состоянии, были выполнены действия для приведения хоста в это состояние. Продемонстрируем это, выполня команду установки Nginx еще раз:</p>
<div class="highlight"><pre><span></span><code>$ ansible -b -m apt -a &#39;name=nginx state=present&#39; vm2
</code></pre></div>
<p>Обратите внимание на статус ok и на то как быстро завершился модуль. Ansible проверил что пакет nginx уже установлен и не стал ничего делать.<br />
Теперь заменим конфигурацию Nginx на nginx. conf, чтобы наш сервер проксировал все запросы на сервис тестирования запросов <a href="https://httpbin.org/">httpbin.org</a>.  </p>
<p>Содержимое файла nginx. conf:</p>
<div class="highlight"><pre><span></span><code>user www-data;
worker_processes auto;
pid /run/nginx.pid;
include /etc/nginx/modules-enabled/*.conf;

events {
  worker_connections 768;
}

http {
  sendfile on;
  tcp_nopush on;
  types_hash_max_size 2048;

  include /etc/nginx/mime.types;
  default_type application/octet-stream;

  access_log /var/log/nginx/access.log;
  error_log /var/log/nginx/error.log;

  gzip on;

  server {
    listen 80 default_server;

    location / {
      proxy_pass https://httpbin.org;
    }
  }
}
</code></pre></div>
<p>Для копирования файла на хост воспользуемся модулем copy:</p>
<div class="highlight"><pre><span></span><code>$ ansible -b -m copy -a &#39;src=nginx.conf dest=/etc/nginx/nginx.conf owner=root group=root mode=644&#39; vm2
</code></pre></div>
<p>Чтобы Nginx перечитал конфигурацию подадим процессу команду reload при помощи systemd:</p>
<div class="highlight"><pre><span></span><code>$ ansible -b -m systemd_service -a &#39;name=nginx.service state=reloaded&#39; vm2
</code></pre></div>
<p>Проверим корректность конфигурации, сделав запрос к httpbin.org через Nginx при помощи модуля url:</p>
<div class="highlight"><pre><span></span><code>$ ansible -m uri -a &#39;url=&quot;http://127.0.0.1/status/200&quot;&#39; vm2
</code></pre></div>
<p>Теперь отменим все наши изменения:</p>
<div class="highlight"><pre><span></span><code>$ ansible -b -m systemd_service -a &#39;name=nginx.service enabled=false state=stopped&#39; vm2
$ ansible -b -m apt -a &#39;name=nginx state=absent&#39; vm2
$ ansible -b -m file -a &#39;path=/etc/nginx state=absent&#39; vm2
</code></pre></div>
<p>Здесь мы использовали модуль file, который используется для работы с файлами и директориями на целевых хостах. С его помощью мы будем изменять атрибуты файлов, создавать директории, создавать пустые папки, удалять файлы и директории.</p>
<p>Плейбуки</p>
<p>Заметим, что при помощи последовательного вызова консольных команд сложно построить какой-либо сценарий автоматизации. Поэтому для для написания сценариев в Ansible используются плеи — последовательности задач, запускаемые на конкретном наборе целей, которые группируются в плейбуки. Написать один плей в Ansible нельзя, поэтому создадим плейбук nginx_simple.play.yml, повторяющий ручные действия:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  tasks:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: nginx
        update_cache: true
        state: present
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
    - name: Copy config
      ansible.builtin.copy:
        src: nginx.conf
        dest: /etc/nginx/nginx.conf
        owner: root
        group: root
        mode: &quot;644&quot;
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
</code></pre></div>
<p>Заметим, что в корне файла находится список плеев (в нашем случае из одного элемента) и каждый плей содержит имя (name), набор целей (hosts) и список задач (tasks). Также указан опциональный параметр become, аналогичный опции -b, чтобы модули выполнялись из-под суперпользователя.  </p>
<p>В отличие от ручного запуска модулей настоятельно рекомендуется давать всем задачам и плеям понятные имена, чтобы лог действий Ansible был проще и понятнее.<br />
Запустим наш плейбук при помощи команды ansible-playbook:</p>
<div class="highlight"><pre><span></span><code>$ ansible-playbook nginx_simple.play.yml
</code></pre></div>
<p>Параметризуем наш плей, вынеся пути копируемого файла в переменные:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  vars:
    nginx__config_src: nginx.conf
    nginx__config_dest: /etc/nginx/nginx.conf
  tasks:
    - name: Install nginx package
      ansible.builtin.apt:
        name: nginx
        update_cache: true
        state: present
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
</code></pre></div>
<p>Теперь вместо конкретных путей к файлу в задаче Copy config используется шаблон (обратите внимание на {{ и }}) внутри которого подставляется значение переменных nginx__config_src и nginx__config_dest.  </p>
<p>Здесь вместо переменных, указанных напрямую в плее, могут использоваться переменные инвентаря и переменные заданные при запуске команды ansible-playbook аргументом -e. Следовательно мы можем использовать другую конфигурацию, переопределив переменную в инвентаре или командной строке.</p>
<p>Обратите внимание на длинные названия переменных: в Ansible все переменные глобальны, поэтому не используйте простые имена как i, src, dest, target и т. п. Наличие одинаковых переменных в нескольких источниках (переменных роли, плейбука, инвентаря) приведет к их перетиранию и отладочным сессиям, где вы будете выяснять какое именно значение переменной используется при запуске и откуда оно берется.</p>
<p>Ansible использует шаблоны для реализации подстановки значений переменных и любых вычислений во время работы сценария. При помощи шаблонов мы будем, например, запускать задачи только на хостах с определенной конфигурацией или создавать конфиги, зависящие от переменных инвентаря.  </p>
<p>В качестве языка шаблонов Ansible использует <a href="https://jinja.palletsprojects.com/en/3.0.x/">Jinja2</a>, который может быть знаком Python разработчикам, т.к. он широко используется в Web фреймворках, таких как Django и Flask для генерации HTML на стороне сервера. Мы обсудим Jinja2 далее, сейчас же рассмотрим основные приемы написания плейбуков.  </p>
<p>Заметим, что при повторных запусках плейбука задача Reload Nginx service всегда имеет статус changed как будто он создает изменения. Несложно заметить, что никаких изменений задача не производит, а лишь вынуждает Nginx бесцельно перечитывать свой конфиг. Такие задачи в Ansible называют неидемпотентными, т.к. они не изменяют видимое состояние цели (или Ansible не может отследить это изменение).  </p>
<p>Появление таких задач — следствие того, что Ansible не использует для никаких внутренних механизмов для отслеживания состояния целей и возлагает на разработчиков обязанность писать идемпотентные сценарии, т. е. такие сценарии которые переводят цель из одного отслеживаемого состояния в другое такое состояние.  </p>
<p>Ключевое свойство идемпотентных сценариев — при повторном запуске сценарий не сделает никаких изменений. Писать неидемпотентный код на Ansible очень просто, например использование модулей command и shell, запускающих произвольные команды, неидемпотентно, т.к. Ansible не может отследить что именно изменили эти команды (и изменили ли вообще).  </p>
<p>Исправим неидемпотентность нашего плея: запустим плейбук, включив более подробный вывод (-v) и заметим, что все задачи после запуска выводят какой-то JSON документ — это результат выполнения задачи. Он зависит от модуля, но содержит несколько общих параметров, например статус задачи.  </p>
<p>Мы можем записать результат выполнения задачи в переменную Ansible при помощи директивы register. Сохраним результат задачи Copy config, чтобы запускать Reload Nginx service только тогда, когда Copy config выполнила изменения:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  vars:
    nginx__config_src: nginx.conf
    nginx__config_dest: /etc/nginx/nginx.conf
  tasks:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: nginx
        update_cache: true
        state: present
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
      register: __copy_config
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
</code></pre></div>
<p>Теперь добавим условие запуска для задачи Reload Nginx service при помощи директивы when -- она принимает как аргумент выражение Jinja2 без скобок ({{ и }}), которое должно возвращать true или false.  </p>
<p>Наш случай очень прост, т.к. для него в Ansible предусмотрен Jinja2 тест changed. Тесты Jinja2 — это функции, принимающие один аргумент и возвращающие true или false, они вызываются так — ARG is TEST_NAME и используются для проверки условий.  </p>
<p>Добавим when к задаче Reload Nginx service:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  vars:
    nginx__config_src: nginx.conf
    nginx__config_dest: /etc/nginx/nginx.conf
  tasks:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: nginx
        update_cache: true
        state: present
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
      register: __copy_config
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
      when: __copy_config is changed
</code></pre></div>
<p>Список тестов Jinja2 смотри в <a href="https://jinja.palletsprojects.com/en/3.0.x/templates/#list-of-builtin-tests">документации</a>, также Ansible определяет свои тесты, такие как changed — <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_tests.html">документация</a>.</p>
<p>Перезапустим плейбук и обратим внимание, что задача Reload Nginx service завершилась со статусом skipped — это статус для задач, пропущенных из-за невыполненного условия when.  </p>
<p>Вы можете подумать, что это довольно неуклюжее решение для такой простой проблемы и будете абсолютно правы. Для решения этой проблемы Ansible опрелеляет хендлеры (handlers) —- задачи, запускаемые при изменении в других задачах.  </p>
<p>Перенесем задачу Reload Nginx service в секцию handlers плея:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  vars:
    nginx__config_src: nginx.conf
    nginx__config_dest: /etc/nginx/nginx.conf
  tasks:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: nginx
        update_cache: true
        state: present
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
      notify:
        - Reload Nginx service
  handlers:
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
</code></pre></div>
<p>Мы вынесли задачу Reload Nginx service в отдельный список handlers. Задачи в этом списке независимы и не запускаются последовательно. Вместо этого они запускаются в конце выполнения плея в случае, если они были запрошены одной из основных задач.  </p>
<p>Запрос выполняется директивой notify, которая принимает как аргумент имя одного или нескольких хендлеров.<br />
Изменим конфиг Nginx, добавив комментарий:</p>
<div class="highlight"><pre><span></span><code>user www-data;
worker_processes auto;
pid /run/nginx.pid;
include /etc/nginx/modules-enabled/*.conf;

events {
  worker_connections 768;
}

http {
  sendfile on;
  tcp_nopush on;
  types_hash_max_size 2048;

  include /etc/nginx/mime.types;
  default_type application/octet-stream;

  access_log /var/log/nginx/access.log;
  error_log /var/log/nginx/error.log;

  gzip on;

  server {
    listen 80 default_server;

    # Proxy to httpbin.org
    location / {
      proxy_pass https://httpbin.org;
    }
  }
}
</code></pre></div>
<p>Перезапустим плейбук:</p>
<div class="highlight"><pre><span></span><code>$ ansible-playbook nginx_simple.play.yml
</code></pre></div>
<p>Обратите внимание на появившуюся секцию RUNNING HANDLER в выводе ansible-playbook. Запустим плейбук еще раз и заметим, что хендлеры не запустились, т.к. Copy config ничего не изменила.  </p>
<p>Также добавим хендлер к задаче Install nginx package, чтобы перезапускать Nginx при обновлении:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  vars:
    nginx__config_src: nginx.conf
    nginx__config_dest: /etc/nginx/nginx.conf
  tasks:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: nginx
        update_cache: true
        state: present
      notify:
        - Restart Nginx
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
      notify:
        - Reload Nginx service
  handlers:
    - name: Restart Nginx
      ansible.builtin.systemd_service:
        name: nginx.service
        state: restarted
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
</code></pre></div>
<p>Приглядимся внимательнее к задаче Install nginx package: как вообще обновить Nginx при помощи этой задачи? Ее параметры говорят, что задача устанавливает Nginx какой-либо версии и если Nginx уже установлен, то ее запуск не создаст изменений.<br />
Следовательно, после первой установки такой плейбук никогда не обновит Nginx и со временем его использование приведет к дрейфу конфигураций (configuration drift) — ситуации, когда фактическое состояние однотипных целей (настраиваемых при помощи одинаковых сценариев с одинаковым набором переменных) отличается.  </p>
<p>В нашей ситуации дрейф наступает при настройке второго хоста через несколько месяцев, после выхода следующего релиза Nginx. На практике дрейф неизбежен и наша задача как разработчиков сценариев автоматизации -- минимизировать его.  </p>
<p>Как это сделать здесь? Документация модуля apt говорит о параметре state: latest, который вынудит задачу Install nginx package обновлять Nginx до последней версии при запуске. Такое решение частично решит проблему, но снова сделает плей неидемпотентным, что также нас не устраивает. Фиксация версии пакета в переменной решает обе проблемы:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  vars:
    nginx__version: &quot;1.18.0*&quot;
    nginx__config_src: nginx.conf
    nginx__config_dest: /etc/nginx/nginx.conf
  tasks:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: &quot;nginx={\{ nginx__version }\}&quot;
        update_cache: true
        state: present
      notify:
        - Restart Nginx
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
      notify:
        - Reload Nginx service
  handlers:
    - name: Restart Nginx
      ansible.builtin.systemd_service:
        name: nginx.service
        state: restarted
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
</code></pre></div>
<p>Теперь, чтобы обновить Nginx, нужно обновить версию пакета в плейбуке, что сделает изменение явным. Но фиксация версий всех пакетов хоста и их регулярное обновление — трудоемкая задача, поэтому помните, что лучшее — враг хорошего, и фиксируйте действительно важные для системы параметры.<br />
[Версия пакета PostgreSQL на серверах БД должна быть зафиксирована, но, например, службу NetworkManager можно обновлять произвольно.]  </p>
<p>Сейчас мы предполагаем, что конфиг, передаваемый в Copy config корректен, но это часто не так. Текущая реализация, получив некорректный конфиг, заменит старый конфиг и либо уронит Nginx, либо Nginx напишет в лог предупреждение и не заменит конфиг, что вызовет падение при следующем перезапуске Nginx в будущем.  </p>
<p>К счастью, Nginx умеет валидировать свои конфиги командой nginx -t -c ABSOLULE_PATH_TO_CONFIG. Модифицируем наш плейбук так, чтобы валидировать конфиг перед обновлением:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  vars:
    nginx__version: &quot;1.18.0&quot;
    nginx__config_src: nginx.conf
    nginx__config_temp: /etc/nginx/nginx.new.conf
    nginx__config_dest: /etc/nginx/nginx.conf
  tasks:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: &quot;nginx={\{ nginx__version }\}&quot;
        update_cache: true
        state: present
      notify:
        - Restart Nginx
    - name: Copy new config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ nginx__config_temp }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
    - name: Validate new config
      ansible.builtin.command:
        cmd: &quot;nginx -t -c &#39;{\{ nginx__config_temp }\}&#39;&quot;
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_temp }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
        remote_src: true
      notify:
        - Reload Nginx service
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
  handlers:
    - name: Restart Nginx
      ansible.builtin.systemd_service:
        name: nginx.service
        state: restarted
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
</code></pre></div>
<p>Здесь мы использовали модуль command, чтобы выполнить произвольную команду на цели и снова сделали плейбук неидемпотентным, т.к. Ansible не знает изменил ли что-либо запуск команды на хосте. Мы же знаем, что эта команда ничего не изменяет.  </p>
<p>Чтобы задать это явно используется директива changed_when, которая принимает выражение Jinja2, возвращающее true, когда команда сделала изменения и false иначе (для вычисления этого выражения часто используют результат выполнения модуля). В нашем случае команда никогда не приводит к изменениям, напишем в условии false:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  become: true
  vars:
    nginx__version: &quot;1.18.0&quot;
    nginx__config_src: nginx.conf
    nginx__config_temp: /etc/nginx/nginx.new.conf
    nginx__config_dest: /etc/nginx/nginx.conf
  tasks:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: &quot;nginx={\{ nginx__version }\}&quot;
        update_cache: true
        state: present
      notify:
        - Restart Nginx
    - name: Copy new config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ nginx__config_temp }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
    - name: Validate new config
      ansible.builtin.command:
        cmd: &quot;nginx -t -c &#39;{\{ nginx__config_temp }\}&#39;&quot;
      changed_when: false
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_temp }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
        remote_src: true
      notify:
        - Reload Nginx service
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
  handlers:
    - name: Restart Nginx
      ansible.builtin.systemd_service:
        name: nginx.service
        state: restarted
    - name: Reload Nginx service
      ansible.builtin.systemd_service:
        name: nginx.service
        state: reloaded
</code></pre></div>
<p>На этом закончим доработки нашего плея.</p>
<p>Роли</p>
<p>Несложно представить, что нам потребуется использовать этот сценарий в нескольких инвентарях или на нескольких независимых целях в одном. Для таких случаев в Ansible предусмотрены роли (roles) — именованные группы задач, у которых явно объявлены входные параметры.  </p>
<p>Создадим в рабочей области папку для будущих ролей:</p>
<div class="highlight"><pre><span></span><code>$ mkdir -p roles
</code></pre></div>
<p>Теперь создадим новую роль при помощи утилиты ansible-galaxy:</p>
<div class="highlight"><pre><span></span><code>$ ansible-galaxy init ./roles/nginx
</code></pre></div>
<p>Роли Ansible состоят из нескольких компонентов, организованных в фиксированную структуру папок:</p>
<div class="highlight"><pre><span></span><code>$ tree ./roles/nginx
./roles/nginx
├── defaults
│   └── main.yml
├── files
├── handlers
│   └── main.yml
├── meta
│   └── main.yml
├── tasks
│   └── main.yml
├── templates
├── tests
│   ├── inventory
│   └── test.yml
├── vars
│   └── main.yml
└── README.md
</code></pre></div>
<p>defaults — значения по умолчанию для параметров роли; здесь описываются все переменные, которые может переопределить пользователь роли;<br />
files — статичные файлы (чаще всего для копирования на цели);<br />
handlers — хендлеры роли;<br />
meta — метаданные для публикации в репозитории Ansible ролей;<br />
tasks — задачи роли;<br />
templates — шаблонизированные файлы (чаще всего для копирования на хосты параметризованных конфигов);<br />
tests — тесты роли;<br />
vars — внутренние переменные роли, которые не должны переопределяться пользователем;<br />
<a href="http://readme.md/">README.md</a> — описание роли.</p>
<p>Подробнее смотри в <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_reuse_roles.html#role-directory-structure">документации</a>.</p>
<p>Мы не будем сегодня рассматривать публикацию ролей и их тестирование, поэтому удалим эти директории (здесь и далее все команды выполняются из папки с ролью):</p>
<div class="highlight"><pre><span></span><code>$ rm -rf ./tests ./meta
</code></pre></div>
<p>Структура репозитория</p>
<div class="highlight"><pre><span></span><code>$ tree .
.
├── inventories
│   └── main
│       ├── group_vars
│       ├── host_vars
│       └── hosts.yaml
├── roles
│   └── nginx
├── ansible.cfg
├── nginx_simple.play.yml
└── README.md
</code></pre></div>
<p>Он отличается от текущего тем, что инвентари вынесены в отдельные папки (main) в папке inventories. Изменим инвентарь:</p>
<div class="highlight"><pre><span></span><code>$ mkdir -p inventories/main/{group_vars,host_vars}
$ mv hosts.yaml inventories/main/hosts.yaml
</code></pre></div>
<p>Также изменим путь к инвентарю по-умолчанию в ansible.cfg:</p>
<div class="highlight"><pre><span></span><code>[defaults]
host_key_checking = false
inventory = inventories/main
</code></pre></div>
<p>Подробнее о структуре репозитория смотри в <a href="https://docs.ansible.com/ansible/latest/tips_tricks/sample_setup.html#alternative-directory-layout">документации</a>.</p>
<p>Установка Nginx в виде роли</p>
<p>Приступим к написанию роли Nginx. Для начала перенесем плейбук в роль без изменений. Скопируем параметры в defaults/main.yml:</p>
<div class="highlight"><pre><span></span><code>nginx__version: &quot;1.18.0&quot;
nginx__config_src: nginx.conf
nginx__config_temp: /etc/nginx/nginx.new.conf
nginx__config_dest: /etc/nginx/nginx.conf
</code></pre></div>
<p>Вынесем переменную nginx__config_temp, т.к. это деталь реализации, которую пользователь может проигнорировать. Перенесем ее в vars/main.yml, переименовав в __config_temp:</p>
<div class="highlight"><pre><span></span><code>__config_temp: &quot;/etc/nginx/nginx.conf.new&quot;
</code></pre></div>
<p>Мы продолжаем давать переменным странные имена из-за того, что в Ansible все переменные глобальны и пересечение имен переменных приведет к сложным при отладке ошибкам.</p>
<p>Скопируем задачи в tasks/main.yml:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx package
  ansible.builtin.apt:
    name: &quot;nginx={\{ nginx__version }\}&quot;
    update_cache: true
    state: present
  notify:
    - Restart Nginx
- name: Copy new config
  ansible.builtin.copy:
    src: &quot;{\{ nginx__config_src }\}&quot;
    dest: &quot;{\{ __config_temp }\}&quot;
    owner: root
    group: root
    mode: &quot;644&quot;
- name: Validate new config
  ansible.builtin.command:
    cmd: &quot;nginx -t -c &#39;{\{ __config_temp }\}&#39;&quot;
  changed_when: false
- name: Copy config
  ansible.builtin.copy:
    src: &quot;{\{ __config_temp }\}&quot;
    dest: &quot;{\{ nginx__config_dest }\}&quot;
    owner: root
    group: root
    mode: &quot;644&quot;
    remote_src: true
  notify:
    - Reload Nginx service
- name: Enable Nginx service now
  ansible.builtin.systemd_service:
    name: nginx.service
    enabled: true
    state: started
</code></pre></div>
<p>Заметим, что теперь нам негде указать become: true, т.к. раньше мы делали это в параметрах плея. Мы можем указать этот параметр в каждой задаче, но это довольно громоздко.  </p>
<p>Для вынесения общих параметров группы задач в Ansible используется специальный модуль block — он принимает на вход группу задач и применяет к ним свои директивы:</p>
<div class="highlight"><pre><span></span><code>- name: Configure Nginx
  become: true
  block:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: &quot;nginx={\{ nginx__version }\}&quot;
        update_cache: true
        state: present
      notify:
        - Restart Nginx
    - name: Copy new config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ __config_temp }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
    - name: Validate new config
      ansible.builtin.command:
        cmd: &quot;nginx -t -c &#39;{\{ __config_temp }\}&#39;&quot;
      changed_when: false
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ __config_temp }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
        remote_src: true
      notify:
        - Reload Nginx service
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
</code></pre></div>
<p>К блокам можно применить почти все параметры задач, например when, чтобы выполнить группу задач по условию.  </p>
<p>Также блоки можно использовать как аналог try-catch для обработки ошибок при помощи директив always и rescue — они принимают на вход список задач, которые выполняются после блока либо всегда (независимо от того, возникла ли ошибка в одной из задач модуля), либо при ошибке в одной из задач.  </p>
<p>Добавим удаление временного конфига ({{ __config_temp }}) при ошибке:</p>
<div class="highlight"><pre><span></span><code>- name: Configure Nginx
  become: true
  block:
    - name: Install Nginx package
      ansible.builtin.apt:
        name: &quot;nginx={\{ nginx__version }\}&quot;
        update_cache: true
        state: present
      notify:
        - Restart Nginx
    - name: Copy new config
      ansible.builtin.copy:
        src: &quot;{\{ nginx__config_src }\}&quot;
        dest: &quot;{\{ __config_temp }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
    - name: Validate new config
      ansible.builtin.command:
        cmd: &quot;nginx -t -c &#39;{\{ __config_temp }\}&#39;&quot;
      changed_when: false
    - name: Copy config
      ansible.builtin.copy:
        src: &quot;{\{ __config_temp }\}&quot;
        dest: &quot;{\{ nginx__config_dest }\}&quot;
        owner: root
        group: root
        mode: &quot;644&quot;
        remote_src: true
      notify:
        - Reload Nginx service
    - name: Enable Nginx service now
      ansible.builtin.systemd_service:
        name: nginx.service
        enabled: true
        state: started
  rescue:
    - name: Remove new config on error
      file:
        path: &quot;{\{ __config_temp }\}&quot;
        state: absent
</code></pre></div>
<p>Скопируем хендлеры в handlers/main.yml:</p>
<div class="highlight"><pre><span></span><code>- name: Restart Nginx
  ansible.builtin.systemd_service:
    name: nginx.service
    state: restarted
- name: Reload Nginx service
  ansible.builtin.systemd_service:
    name: nginx.service
    state: reloaded
</code></pre></div>
<p>Столкнемся с проблемой, аналогичной задачам: негде указать become: true. Но в отличие от задач мы не можем объединять хендлеры в блоки, т.к. каждый хендлер — независимая задача. Напишем become: true явно в каждом:</p>
<div class="highlight"><pre><span></span><code>- name: Restart Nginx
  ansible.builtin.systemd_service:
    name: nginx.service
    state: restarted
  become: true
- name: Reload Nginx service
  ansible.builtin.systemd_service:
    name: nginx.service
    state: reloaded
  become: true
</code></pre></div>
<p>Мы переделали наш плей в роль, заменим задачи в плейбуке nginx_simple.play.yml на вызов роли:</p>
<div class="highlight"><pre><span></span><code>- name: Install Nginx on vm2
  hosts: vm2
  roles:
    - nginx
</code></pre></div>
<p>Наша роль подойдет для настройки Nginx в качестве простой TCP прокси, но Nginx чаще используют для сложных сценариев L7 балансировки, когда за прокси скрывается множество HTTP сервисов. Пользователю роли в таком случае придется написать полный конфиг руками, что не очень удобно и чревато ошибками.  </p>
<p>На следующем занятии переработаем роль для установки Nginx как L7 балансировщика.</p>
<p>Домашнее задание</p>
<p>Напишите роль для установки PostgreSQL и плейбук, устанавливающий СУБД на ВМ2.  </p>
<p>Роль должна выполнять следующие операции:<br />
</p>
<ol>
<li>Установку пакета PostgreSQL из стандартных репозиториев Ubuntu (подключать deb-репозитории PostgreSQL не нужно);</li>
<li>Настройку директорий с данными PostgreSQL (роль должна принимать директорию с данными как параметр, значение по-умолчанию -- /data/postgres/data);</li>
<li>Первичную инициализацию БД при помощи команды pg_ctl initdb -D $PGDATA;</li>
<li>Конфигурация PostgreSQL при помощи файла $PGDATA/postgresql.conf (роль должна принимать параметры конфигурации PostgreSQL в виде словаря);</li>
<li>Конфигурация параметров авторизации при помощи файла $PGDATA/pg_hba.conf (роль должна принимать последовательность правил авторизации в виде списка словарей);</li>
<li>Запуск PostgreSQL как systemd-службы;</li>
<li>Проверку работоспособности PostgreSQL при помощи выполнения в СУБД запроса SELECT 1;</li>
<li>Создание пользовательских БД;</li>
<li>Создание пользователей;</li>
<li>Установку <a href="https://github.com/prometheus-community/postgres_exporter">postgres-exporter</a> на цели;</li>
<li>Запуск postgres-exporter как systemd-службы;</li>
</ol>
<p>Для проверки предоставьте:  </p>
<ul>
<li>Ссылку на исходный код роли в репозитории оформленном в соответствии структуры из занятия 3;</li>
<li>Ссылку на исходный код плейбука в том же репозитории;</li>
</ul>
<p>Пояснения</p>
<p>Права директорий PostgreSQL<br />
В пункте 2 убедитесь, что создаете папку /data с владельцем root: root и правами 0755, чтобы избежать ограничений доступа при просмотре корня файловой системы. Директорию /data/postgres создавайте с владельцем postgres: postgres и правами 0700.  </p>
<p>Директива creates для отслеживания изменений в модулях command и shell<br />
В третьей практике мы обсуждали один из способов выполнить модули command и shell идемпотентно — задать условие changed_when вручную. Во втором пункте такое решение неоптимально, т.к. оно полагается на парсинг вывода команды pg_ctl initdb.  </p>
<p>Вместо него используйте директиву creates, которая принимает как аргумент путь на цели и считает, что указанный модуль должен создать этот путь. Т. е. задача считается changed, если до запуска этого пути не было, а после -- появился. Если же путь существовал до запуска, то задача пропускается со статусом ok.  </p>
<p>Пример:</p>
<div class="highlight"><pre><span></span><code>- name: Create directory via command
  ansible.builtin.command:
    cmd: mkdir /data
  creates: /data
</code></pre></div>
<p>Не делайте так, используйте модуль file со state: directory.</p>
<p>Сохранение значений по умолчанию <br />
в конфиге PostgreSQL</p>
<p>Обратите внимание, что initdb создает непустой конфиг postgresql. conf и вам нужно позаботиться о сохранении значений по-умолчанию. Вы можете подойти к этой задаче двумя способами:  </p>
<ol>
<li>Генерация полного конфига при помощи <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html">template</a>. Значения по-умолчанию подставляются из приватных переменных роли путем слияния с пользовательскими параметрами;</li>
<li>Точечная замена конфигурационных опций при помощи модуля <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html">lineinfile</a>;</li>
</ol>
<p>Первый способ выглядит так:<br />
Объявляем пользовательские переменные в defaults/main.yml:</p>
<div class="highlight"><pre><span></span><code>postgres__opts:
  param1: value1
  param2: value2
</code></pre></div>
<p>И параметры по-умолчанию в vars/main.yml (скопируйте их из сгенерированного конфига):</p>
<div class="highlight"><pre><span></span><code>__opts_default:
  param1: value1_default
  param3: value3_default
</code></pre></div>
<p>Затем сливаем их при помощи фильтра <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/combine_filter.html">combine</a> в шаблоне templates/postgresql.conf.j2:</p>
<div class="highlight"><pre><span></span><code>{\% set opts = __opts_default | combine(postgres__opts) \%}
</code></pre></div>
<p>И копируем конфиг при помощи модуля <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html">template</a>.<br />
Во втором способе будем использовать модуль <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html">lineinfile</a>, который использует регулярное выражение, чтобы найти строку с нашей опцией и заменить ее на пользовательское значение.<br />
Аналогично объявим пользовательские переменные в defaults/main.yml:</p>
<div class="highlight"><pre><span></span><code>postgres__opts:
  param1: value1
  param2: value2
</code></pre></div>
<p>Теперь напишем цикл по параметрам с поиском каждого из них:</p>
<div class="highlight"><pre><span></span><code>- name: Edit postgresql.conf
  ansible.builtin.lineinfile:
    path: &quot;{\{ postgres__data_dir }\}/postgresql.conf&quot;
    regexp: &quot;^#?{\{ item.key | regex_escape() }\}\s*=&quot;
    line: &quot;{\{ item.key }\} = {\{ item.value }\}&quot;
    create: false
  loop: &quot;{\{ postgres__opts | dict2items }\}&quot;
  loop_control:
    label: &quot;{\{ item.key }\}&quot;
</code></pre></div>
<p>Здесь мы использовали следующие фильтры:  </p>
<ul>
<li>dict2items — конвертирует словарь в список словарей с ключами key и value, нужен для использования словарей как параметров циклов;</li>
<li>regex_escape () — экранирование спец-символов регулярных выражений в строке, нужно чтобы все символы в item. key воспринимались буквально.</li>
</ul>
<p>Коллекция community.postrgesql</p>
<p>Для выполнения пунктов 5, 7, 8, 9 можете воспользоваться коллекцией community.postgresql, установку которой обсудили на пятой практике. Обратите внимание, что коллекция требует установки на цели Python пакета psycopg2. Установите его в первом пункте вместе с пакетами PostgreSQL, если планируете использовать. Название пакета в дистрибутиве Ubuntu: python3-psycopg2.</p>
<p>Значения по умолчанию <br />
в модулях community.postgresql</p>
<p>Довольно часто мы предоставляем в ролях интерфейсы к модулям со своими значениями по-умолчанию. Чтобы не дублировать эти значения в фильтре default так:</p>
<div class="highlight"><pre><span></span><code>- name: Create Databases
  community.postgresql.postgresql_db:
    name: &quot;{\{ item.name }\}&quot;
    encoding: &quot;{\{ item.encoding | default(&#39;&#39;) }\}&quot;
    state: &quot;{\{ item.state | default(&#39;present&#39;) }\}&quot;
  loop: &quot;{\{ postgres__databases }\}&quot;
</code></pre></div>
<p>используйте специальную константу <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_filters.html#making-variables-optional">omit</a> — если эта константа является результатом шаблона в параметре модуля, то Ansible игнорирует этот параметр будто он не был написан вовсе.  </p>
<p>Получим:</p>
<div class="highlight"><pre><span></span><code>- name: Create Databases
  community.postgresql.postgresql_db:
    name: &quot;{\{ item.name }\}&quot;
    encoding: &quot;{\{ item.encoding | default(omit) }\}&quot;
    state: &quot;{\{ item.state | default(omit) }\}&quot;
  loop: &quot;{\{ postgres__databases }\}&quot;
</code></pre></div>
<p>Таким образом, если элементом цикла будет {"name": «database"}, то после подстановки шаблона получим такую задачу:</p>
<div class="highlight"><pre><span></span><code>- name: Create Databases
  community.postgresql.postgresql_db:
    name: &quot;database&quot;
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  К началу
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Нижний колонтитул" >
        
          
          <a href="../../linux_tools/home_work/" class="md-footer__link md-footer__link--prev" aria-label="Назад: Домашнее задание №2">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Назад
              </span>
              <div class="md-ellipsis">
                Домашнее задание №2
              </div>
            </div>
          </a>
        
        
          
          <a href="../home_work/" class="md-footer__link md-footer__link--next" aria-label="Вперед: Домашнее задание №3">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Вперед
              </span>
              <div class="md-ellipsis">
                Домашнее задание №3
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2024, Vladimir Penzin
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://t.me/vpotd" target="_blank" rel="noopener" title="Vladimir Penzin on Telegram" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8m114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.45 10.45 0 0 1 3.53 6.716 43.8 43.8 0 0 1 .417 9.769"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/ForceFledgling" target="_blank" rel="noopener" title="Vladimir Penzin on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.action.edit", "navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "navigation.instant.progress", "navigation.top", "search.highlight", "search.share"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0444\u0435\u0440", "clipboard.copy": "\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440", "search.result.more.one": "\u0415\u0449\u0451 1 \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.more.other": "\u0415\u0449\u0451 # \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.none": "\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e", "search.result.one": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e 1 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435", "search.result.other": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439: #", "search.result.placeholder": "\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430", "search.result.term.missing": "\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442", "select.version": "\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0435\u0440\u0441\u0438\u044e"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>